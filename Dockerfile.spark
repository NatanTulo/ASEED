# Spark Master/Worker image
FROM bitnami/spark:3.5.0

USER root

# Install additional Python packages for Spark applications
RUN pip install --no-cache-dir \
    kafka-python==2.0.2 \
    pandas==2.1.3 \
    pyspark==3.5.0

# Copy application code
COPY src/ /opt/spark-apps/
RUN mkdir -p /opt/spark-logs

# Set permissions
RUN chown -R 1001:1001 /opt/spark-apps /opt/spark-logs

USER 1001

# Default command for Spark master
CMD ["spark-class", "org.apache.spark.deploy.master.Master"]
